<launch>
  <arg name="rosbag" default="false" />
  <include file="$(find friedegg_generator)/launch/load_rosbag.launch" if="$(arg rosbag)">
      <arg name="bagname" value="pan_detect.bag"/>
  </include>
  <node type="rviz" name="rviz" pkg="rviz" args="-d $(find friedegg_generator)/config/pan_detect.rviz"/>

  <node name="tf_transform_cloud"
          pkg="nodelet" type="nodelet"
          args="standalone jsk_pcl_utils/TfTransformCloud">
          <remap from="~input" to="/kinect_head/depth_registered/points"/>
      <rosparam>
        target_frame_id: base_footprint
      </rosparam>
  </node>

  <node name="mask_image_filter" pkg="jsk_pcl_ros" type="mask_image_filter">
    <param name="~negative" value="false" />
    <remap from="~input" to="/tf_transform_cloud/output" />
    <remap from="~input/mask" to="/pan_mask_image" />
    <remap from="~input/camera_info" to="/kinect_head/rgb/camera_info" />
  </node>

  <node name="polygon_rect_to_mask_image"
        pkg="nodelet" type="nodelet"
        args="standalone jsk_perception/RectToMaskImage">
    <remap from="~input" to="/pan_mask_polygon"/>
    <remap from="~input/camera_info" to="/kinect_head/rgb/camera_info"/>
  </node>

  <!--
  <node name="apply_mask_image"
        pkg="nodelet" type="nodelet"
        args="standalone jsk_perception/ApplyMaskImage">
    <remap from="~input" to="$(arg INPUT_IMAGE)" />
    <remap from="~input/mask" to="/kinect_head/rgb/camera_info" />
    <rosparam>
      approximate_sync: true
    </rosparam>
  </node>
  -->

</launch>
